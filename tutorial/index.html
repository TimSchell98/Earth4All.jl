<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Tutorial · Earth4All.jl documentation</title><meta name="title" content="Tutorial · Earth4All.jl documentation"/><meta property="og:title" content="Tutorial · Earth4All.jl documentation"/><meta property="twitter:title" content="Tutorial · Earth4All.jl documentation"/><meta name="description" content="Documentation for Earth4All.jl documentation."/><meta property="og:description" content="Documentation for Earth4All.jl documentation."/><meta property="twitter:description" content="Documentation for Earth4All.jl documentation."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">Earth4All.jl documentation</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Tutorial</a><ul class="internal"><li><a class="tocitem" href="#Replicating-the-Too-Little-Too-Late-scenario"><span>Replicating the Too Little Too Late scenario</span></a></li><li><a class="tocitem" href="#Replicating-the-Giant-Leap-scenario"><span>Replicating the Giant Leap scenario</span></a></li><li><a class="tocitem" href="#Comparing-the-two-scenarios"><span>Comparing the two scenarios</span></a></li><li><a class="tocitem" href="#Modifying-variable-initial-values-and/or-parameter-values"><span>Modifying variable initial values and/or parameter values</span></a></li></ul></li><li><a class="tocitem" href="../earth4all/">The Earth4All model</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Tutorial</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Tutorial</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/worlddynamics/Earth4All" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/worlddynamics/Earth4All/blob/master/docs/src/tutorial.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="A-tutorial-of-Earth4All.jl"><a class="docs-heading-anchor" href="#A-tutorial-of-Earth4All.jl">A tutorial of Earth4All.jl</a><a id="A-tutorial-of-Earth4All.jl-1"></a><a class="docs-heading-anchor-permalink" href="#A-tutorial-of-Earth4All.jl" title="Permalink"></a></h1><p>The Julia implementation of the Earth4All model allows the user to <em>play</em> with the Earth4All model introduced in <a href="https://www.clubofrome.org/publication/earth4all-book/">Dixson2022</a>. This model is formed by twelve sectors (see the <a href="../earth4all/">The Earth4All model</a> page).</p><p>In the Julia implementation each sector is a Julia module containing a Julia function, which defines the ODE system corresponding to the sector itself. All the ODE systems corresponding to the sectors of the Earth4All model have to be composed. This will produce the entire ODE system of the Earth4All model, which can then be solved.</p><p>Let us now see how we can replicate the two scenarios described in the above mentioned book.</p><h2 id="Replicating-the-Too-Little-Too-Late-scenario"><a class="docs-heading-anchor" href="#Replicating-the-Too-Little-Too-Late-scenario">Replicating the Too Little Too Late scenario</a><a id="Replicating-the-Too-Little-Too-Late-scenario-1"></a><a class="docs-heading-anchor-permalink" href="#Replicating-the-Too-Little-Too-Late-scenario" title="Permalink"></a></h2><p>In order to simulate the Too Little Too Late scenario, we can simply execute the following code (assuming that we started the Julia REPL within the directory the repository).</p><pre><code class="nohighlight hljs">using ModelingToolkit
using PlotlyJS
using WorldDynamics
include(&quot;src/Earth4All.jl&quot;);
e4a_sol = Earth4All.run_tltl_solution();</code></pre><p>This may require some time, because the used Julia packages have to be precompiled.</p><p>In order to check that the solution is consistent with the solution produced by the Vensim implementation (using the Euler solver with time step equal <span>$0.015625$</span>), we can plot the values of any variable according to the two solutions. Suppose, for example, that we want to check the <code>POP</code> variable, which is contained in the population Vensim view (its Vensim name is <code>Population Mp</code>). To this aim we read the values of all variables included in the Vensim population view.   </p><pre><code class="nohighlight hljs">vensim = Earth4All.read_vensim_dataset(&quot;VensimOutput/tltl/population.txt&quot;, &quot; : E4A-220501 TLTL&quot;);</code></pre><p>(note that the second parameter is a string that has to be ignored while reading the variable values).</p><p>We then create the ODE system corresponding to the Population sector.</p><pre><code class="nohighlight hljs">@named pop = Earth4All.Population.population();</code></pre><p>Finally, we compare and plot the values of the variable <code>POP</code> obtained by the Vensim implementation and the WorldDynamics implementation.</p><pre><code class="nohighlight hljs">Earth4All.compare_and_plot(&quot;Too Little Too Late&quot;, e4a_sol, &quot;Population Mp&quot;, pop.POP, vensim, 1980, 2100, 7681, 0.1, true)</code></pre><p>If everything worked fine, the following figure should be produced.</p><div align="center"><img src="../imgs/vensim_vs_worlddynamics/POP_tltl.png" width="500" height="500">
</div><p>As it can be seen, the two curves are (almost) exactly the same.  The function <code>compare_and_plot</code> also print the maximum simmetric relative error, along with the values of the two curves, the iteration index, and the time instant corresponding to this maximum. In the above example, the function should print something similar to the following message.</p><pre><code class="nohighlight hljs">(0.002385476673325227, 7282.516980299014, 7299.91, 7681) at t=2100.0</code></pre><h3 id="Working-with-other-sectors-and/or-other-variables"><a class="docs-heading-anchor" href="#Working-with-other-sectors-and/or-other-variables">Working with other sectors and/or other variables</a><a id="Working-with-other-sectors-and/or-other-variables-1"></a><a class="docs-heading-anchor-permalink" href="#Working-with-other-sectors-and/or-other-variables" title="Permalink"></a></h3><p>In the above example, we worked with the Population sector. In case we want to work with other sectors of the model, we can use one or more of the following instructions.</p><pre><code class="nohighlight hljs">@named cli = Earth4All.Climate.climate();
@named dem = Earth4All.Demand.demand();
@named ene = Earth4All.Energy.energy();
@named fin = Earth4All.Finance.finance();
@named foo = Earth4All.FoodLand.foodland();
@named inv = Earth4All.Inventory.inventory();
@named lab = Earth4All.LabourMarket.labour_market();
@named oth = Earth4All.Other.other();
@named out = Earth4All.Output.output();
@named pop = Earth4All.Population.population();
@named pub = Earth4All.Public.public();
@named wel = Earth4All.Wellbeing.wellbeing();</code></pre><p>Moreover, we analysed the population variable, whose Vensim name is &quot;Population Mp&quot;. In case we want to analyse other variables, we always have to use their exact Vensim name, as indicated in the variable and parameter interactive tables.</p><h2 id="Replicating-the-Giant-Leap-scenario"><a class="docs-heading-anchor" href="#Replicating-the-Giant-Leap-scenario">Replicating the Giant Leap scenario</a><a id="Replicating-the-Giant-Leap-scenario-1"></a><a class="docs-heading-anchor-permalink" href="#Replicating-the-Giant-Leap-scenario" title="Permalink"></a></h2><p>In order to simulate the Giant Leap scenario, we can execute a similar code.</p><pre><code class="nohighlight hljs">e4a_sol = Earth4All.run_gl_solution();
vensim = Earth4All.read_vensim_dataset(&quot;VensimOutput/gl/population.txt&quot;, &quot; : E4A-220501 GL&quot;);
@named pop = Earth4All.Population.population();
Earth4All.compare_and_plot(&quot;Giant Leap&quot;, e4a_sol, &quot;Population Mp&quot;, pop.POP, vensim, 1980, 2100, 7681, 0.1, true)</code></pre><p>If everything worked fine, the following figure should be produced.</p><div align="center"><img src="../imgs/vensim_vs_worlddynamics/POP_gl.png" width="500" height="500"></div><p>Moreover, a message similar to the following one should be printed.</p><pre><code class="nohighlight hljs">(0.0019946923672592228, 5984.450944034332, 5996.4, 7681) at t=2100.0</code></pre><h2 id="Comparing-the-two-scenarios"><a class="docs-heading-anchor" href="#Comparing-the-two-scenarios">Comparing the two scenarios</a><a id="Comparing-the-two-scenarios-1"></a><a class="docs-heading-anchor-permalink" href="#Comparing-the-two-scenarios" title="Permalink"></a></h2><p>In order to compare the dynamics of the variable in tthe two scenariso, we can use the <code>plot_two_sols</code> functions. For example, if we want to see the evolution of the variable <code>POP</code> in the two scenarios, we can execute the following code.</p><pre><code class="nohighlight hljs">using ModelingToolkit
using PlotlyJS
using WorldDynamics
include(&quot;src/Earth4All.jl&quot;);
tltl_sol = Earth4All.run_tltl_solution();
gl_sol = Earth4All.run_gl_solution();
@named pop = Earth4All.Population.population();
Earth4All.plot_two_sols(&quot;TLTL&quot;, tltl_sol, &quot;GL&quot;, gl_sol, pop, &quot;Population Mp&quot;, 1980, 2100, 7681)</code></pre><p>If everything worked fine, the following figure should be produced.</p><div align="center"><img src="../imgs/tltl_vs_gl/POP_tltl_gl.png" width="500" height="500"></div><p>By executing the analogue code for the average wellbeing index variable, instead, the following figure should be produced.</p><div align="center"><img src="../imgs/tltl_vs_gl/AWBI_tltl_gl.png" width="500" height="500"></div><h2 id="Modifying-variable-initial-values-and/or-parameter-values"><a class="docs-heading-anchor" href="#Modifying-variable-initial-values-and/or-parameter-values">Modifying variable initial values and/or parameter values</a><a id="Modifying-variable-initial-values-and/or-parameter-values-1"></a><a class="docs-heading-anchor-permalink" href="#Modifying-variable-initial-values-and/or-parameter-values" title="Permalink"></a></h2><p>The initial value of the variables and the value of the parameters can clearly be changed by modifying the Julia source code of Earth4All.jl (these values are contained in the <code>initialisations.jl</code> and <code>parameters.jl</code> files included in each sector folder). However, Earth4All.jl allows the user to change these values and run the Earth4All model without modifying the source code. Let us see how this can done by considering the following example.</p><p>Suppose that we want to change the minimum desired number of children, specified in the parameter <code>DNCM</code> of the Population sector. Currently, the value of this parameter is <span>$1.2$</span> (see <a href="https://worlddynamics.github.io/Earth4All.jl/variables/population.html#DNCM">the interactive table</a> of the Population sector), and suppose that we want to set this parameter to <span>$2.2$</span>. To this aim, we can execute the following code, which will show the evolution of the population variable and of the observed warming variable produced by the model with the new value of the <code>DNCM</code> parameter.</p><pre><code class="nohighlight hljs">using Pkg
Pkg.activate(&quot;.&quot;);
Pkg.instantiate();
include(&quot;src/Earth4All.jl&quot;);
using ModelingToolkit
using WorldDynamics

pop_mod_pars = Earth4All.Population.getparameters();
pop_mod_pars[:DNCM] = 2.2;
sol = Earth4All.run_e4a_solution(;pop_pars=pop_mod_pars);
@named pop = Earth4All.Population.population();
@named cli = Earth4All.Climate.climate();
reference_variables = [(cli.OW, 0, 3, &quot;OW&quot;), (pop.POP, 0, 20000, &quot;POP&quot;)];
@variables t;
plotvariables(sol, (t, 1980, 2100), reference_variables, title=&quot;DNCMIN=2.2&quot;, showlegend=true, colored=true)</code></pre><p>If everything worked fine, the following figure should be produced.</p><div align="center"><img src="../imgs/dncm_changed/OW_POP_dncm_changed.png" width="500" height="500"></div><p>If, instead, we want to compare the evolution of the observed warming variable in the Too Little Too Late scenario and the same scenario with the new value of the <code>DNCM</code> parameter, we can execute the following code.</p><pre><code class="nohighlight hljs">using Pkg
Pkg.activate(&quot;.&quot;);
Pkg.instantiate();
include(&quot;src/Earth4All.jl&quot;);
using ModelingToolkit
using WorldDynamics

tltl_sol = Earth4All.run_tltl_solution();
pop_mod_pars = Earth4All.Population.getparameters();
pop_mod_pars[:DNCM] = 2.2;
sol = Earth4All.run_e4a_solution(;pop_pars=pop_mod_pars);
@named cli = Earth4All.Climate.climate();
Earth4All.plot_two_sols(&quot;TLTL&quot;, tltl_sol, &quot;DNCMIN=2.2&quot;, sol, cli, &quot;OBserved WArming deg C&quot;, 1980, 2100, 7681)</code></pre><p>If everything worked fine, the following figure should be produced.</p><div align="center"><img src="../imgs/dncm_changed/OW_tltl_dncm_changed.png" width="500" height="500"></div><h3 id="Working-with-other-sectors-and/or-with-variable-initial-values"><a class="docs-heading-anchor" href="#Working-with-other-sectors-and/or-with-variable-initial-values">Working with other sectors and/or with variable initial values</a><a id="Working-with-other-sectors-and/or-with-variable-initial-values-1"></a><a class="docs-heading-anchor-permalink" href="#Working-with-other-sectors-and/or-with-variable-initial-values" title="Permalink"></a></h3><p>In the above example, we worked with the climate and the population sectors and we changed only a parameter value. In case we want to work with other sectors and/or we want to change a variable initial value, we can use one or more of the following instructios.</p><pre><code class="nohighlight hljs">cli_mod_inits = Earth4All.Climate.getinitialisations();
cli_mod_pars = Earth4All.Climate.getparameters();
dem_mod_inits = Earth4All.Demand.getinitialisations();
dem_mod_pars = Earth4All.Demand.getparameters();
ene_mod_inits = Earth4All.Energy.getinitialisations();
ene_mod_pars = Earth4All.Energy.getparameters();
fin_mod_inits = Earth4All.Finance.getinitialisations();
fin_mod_pars = Earth4All.Finance.getparameters();
foo_mod_inits = Earth4All.FoodLand.getinitialisations();
foo_mod_pars = Earth4All.FoodLand.getparameters();
inv_mod_inits = Earth4All.Inventory.getinitialisations();
inv_mod_pars = Earth4All.Inventory.getparameters();
lab_mod_inits = Earth4All.LabourMarket.getinitialisations();
lab_mod_pars = Earth4All.LabourMarket.getparameters();
oth_mod_inits = Earth4All.Other.getinitialisations();
oth_mod_pars = Earth4All.Other.getparameters();
out_mod_inits = Earth4All.Output.getinitialisations();
out_mod_pars = Earth4All.Output.getparameters();
pop_mod_inits = Earth4All.Population.getinitialisations();
pop_mod_pars = Earth4All.Population.getparameters();
pub_mod_inits = Earth4All.Public.getinitialisations();
pub_mod_pars = Earth4All.Public.getparameters();
wel_mod_inits = Earth4All.Wellbeing.getinitialisations();
wel_mod_pars = Earth4All.Wellbeing.getparameters();</code></pre><p>In order to access and/or change a variable initial value or a parameter value, we always have to use the exact acronym of the variable or of the parameter, as indicated in the <code>Name</code> column of the variable and parameter interactive tables, preceded by a column, as we did in the instruction <code>pop_mod_pars[:DNCM] = 2.2;</code>. For example, if we want to change the initial value of the <code>ALbedo (1)</code> variable of the climate sector (which currently is <span>$0.3094$</span>) and set it equal to <span>$0.35$</span>, we can do it by executing the following instruction: <code>cli_mod_inits[:AL] = 0.35;</code>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../earth4all/">The Earth4All model »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.1.2 on <span class="colophon-date" title="Tuesday 7 November 2023 10:55">Tuesday 7 November 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
